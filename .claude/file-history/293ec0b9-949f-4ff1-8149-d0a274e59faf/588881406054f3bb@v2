# Create Claude Workspace Shortcut with Light Blue Icon
# Run this script once to create the desktop shortcut

Add-Type -AssemblyName System.Drawing

$assetsPath = "C:\Users\Password\Documents\ClaudeCodeProjects\assets"
$iconPath = "$assetsPath\claude-icon.ico"
$shortcutPath = "$env:USERPROFILE\Desktop\Claude Workspace.lnk"

# Create assets directory if needed
if (!(Test-Path $assetsPath)) {
    New-Item -ItemType Directory -Path $assetsPath -Force | Out-Null
}

# Create a light blue Claude-inspired icon (simple circle with C)
$size = 256
$bitmap = New-Object System.Drawing.Bitmap($size, $size)
$graphics = [System.Drawing.Graphics]::FromImage($bitmap)
$graphics.SmoothingMode = [System.Drawing.Drawing2D.SmoothingMode]::AntiAlias
$graphics.Clear([System.Drawing.Color]::Transparent)

# Light blue background circle
$lightBlue = [System.Drawing.Color]::FromArgb(255, 100, 180, 255)
$brush = New-Object System.Drawing.SolidBrush($lightBlue)
$graphics.FillEllipse($brush, 8, 8, 240, 240)

# White inner circle (donut shape like Claude logo)
$white = [System.Drawing.Color]::White
$whiteBrush = New-Object System.Drawing.SolidBrush($white)
$graphics.FillEllipse($whiteBrush, 64, 64, 128, 128)

# Light blue center dot
$graphics.FillEllipse($brush, 96, 96, 64, 64)

# Add "C" letter
$font = New-Object System.Drawing.Font("Segoe UI", 72, [System.Drawing.FontStyle]::Bold)
$textBrush = New-Object System.Drawing.SolidBrush($white)
$stringFormat = New-Object System.Drawing.StringFormat
$stringFormat.Alignment = [System.Drawing.StringAlignment]::Center
$stringFormat.LineAlignment = [System.Drawing.StringAlignment]::Center
$rect = New-Object System.Drawing.RectangleF(0, 0, $size, $size)
$graphics.DrawString("C", $font, $textBrush, $rect, $stringFormat)

$graphics.Dispose()

# Save as icon
$icon = [System.Drawing.Icon]::FromHandle($bitmap.GetHicon())
$fileStream = [System.IO.File]::Create($iconPath)
$icon.Save($fileStream)
$fileStream.Close()
$bitmap.Dispose()

Write-Host "Icon created at: $iconPath" -ForegroundColor Green

# Create the shortcut
$shell = New-Object -ComObject WScript.Shell
$shortcut = $shell.CreateShortcut($shortcutPath)
$shortcut.TargetPath = "C:\Windows\System32\wsl.exe"
$shortcut.Arguments = "-e bash -c `"cd /mnt/c/Users/Password/Documents/ClaudeCodeProjects && claude`""
$shortcut.WorkingDirectory = "C:\Users\Password\Documents\ClaudeCodeProjects"
$shortcut.IconLocation = $iconPath
$shortcut.Description = "Launch Claude Code in Workspace"
$shortcut.Save()

Write-Host "Shortcut created at: $shortcutPath" -ForegroundColor Green
Write-Host ""
Write-Host "Done! You should now see 'Claude Workspace' on your desktop with a light blue icon." -ForegroundColor Cyan
