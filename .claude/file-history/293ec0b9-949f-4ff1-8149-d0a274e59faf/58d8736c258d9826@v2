Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName Microsoft.VisualBasic

$username = $env:USERNAME
Write-Host "Setting password for: $username" -ForegroundColor Cyan

# Get password via GUI dialog
$password1 = [Microsoft.VisualBasic.Interaction]::InputBox("Enter your NEW password for user '$username':", "Set Password", "")

if ($password1 -eq "") {
    Write-Host "Cancelled." -ForegroundColor Yellow
    Read-Host "Press Enter to exit"
    exit
}

$password2 = [Microsoft.VisualBasic.Interaction]::InputBox("Confirm your password (type it again):", "Confirm Password", "")

if ($password1 -ne $password2) {
    Write-Host "ERROR: Passwords do not match!" -ForegroundColor Red
    Read-Host "Press Enter to exit"
    exit
}

try {
    $securePassword = ConvertTo-SecureString $password1 -AsPlainText -Force
    Set-LocalUser -Name $username -Password $securePassword
    Write-Host ""
    Write-Host "SUCCESS! Password has been set for $username" -ForegroundColor Green
} catch {
    Write-Host ""
    Write-Host "ERROR: $($_.Exception.Message)" -ForegroundColor Red
}

Write-Host ""
Read-Host "Press Enter to close"
